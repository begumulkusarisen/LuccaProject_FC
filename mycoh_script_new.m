% Script generated by Brainstorm (21-Nov-2025)

% Input files
sFiles = {...
    'sub-032314/@rawsub-032314_EO/results_PNAI_EEG_KERNEL_251203_1457.mat'};

% Start a new report
bst_report('Start', sFiles);

% Process: Coherence NxN [2023]
sFiles = bst_process('CallProcess', 'process_cohere1n', sFiles, [], ...
    'timewindow',    [0, 400], ...
    'scouts',        {'Schaefer_100_7net', {'Cont_Cing_1 L', 'Cont_Cing_1 R', 'Cont_PFCl_1 L', 'Cont_PFCl_1 R', 'Cont_PFCl_2 R', 'Cont_PFCl_3 R', 'Cont_PFCl_4 R', 'Cont_PFCmp_1 R', 'Cont_Par_1 L', 'Cont_Par_1 R', 'Cont_Par_2 R', 'Cont_pCun_1 L', 'Cont_pCun_1 R', 'Default_PFC_1 L', 'Default_PFC_2 L', 'Default_PFC_3 L', 'Default_PFC_4 L', 'Default_PFC_5 L', 'Default_PFC_6 L', 'Default_PFC_7 L', 'Default_PFCdPFCm_1 R', 'Default_PFCdPFCm_2 R', 'Default_PFCdPFCm_3 R', 'Default_PFCv_1 R', 'Default_PFCv_2 R', 'Default_Par_1 L', 'Default_Par_1 R', 'Default_Par_2 L', 'Default_Temp_1 L', 'Default_Temp_1 R', 'Default_Temp_2 L', 'Default_Temp_2 R', 'Default_Temp_3 R', 'Default_pCunPCC_1 L', 'Default_pCunPCC_1 R', 'Default_pCunPCC_2 L', 'Default_pCunPCC_2 R', 'DorsAttn_FEF_1 L', 'DorsAttn_FEF_1 R', 'DorsAttn_Post_1 L', 'DorsAttn_Post_1 R', 'DorsAttn_Post_2 L', 'DorsAttn_Post_2 R', 'DorsAttn_Post_3 L', 'DorsAttn_Post_3 R', 'DorsAttn_Post_4 L', 'DorsAttn_Post_4 R', 'DorsAttn_Post_5 L', 'DorsAttn_Post_5 R', 'DorsAttn_Post_6 L', 'DorsAttn_PrCv_1 L', 'DorsAttn_PrCv_1 R', 'SalVentAttn_FrOperIns_1 L', 'SalVentAttn_FrOperIns_1 R', 'SalVentAttn_FrOperIns_2 L', 'SalVentAttn_Med_1 L', 'SalVentAttn_Med_1 R', 'SalVentAttn_Med_2 L', 'SalVentAttn_Med_2 R', 'SalVentAttn_Med_3 L', 'SalVentAttn_PFCl_1 L', 'SalVentAttn_ParOper_1 L', 'SalVentAttn_TempOccPar_1 R', 'SalVentAttn_TempOccPar_2 R', ...
    }}, ...
    'flatten',       0, ...
    'scouttime',     'before', ...  % before   
    'scoutfunc',     'mean', ...  % Mean 
    'scoutfuncaft',  'mean', ...  % Mean 
    'pcaedit',       struct(...
         'Method',         'pca', ...
         'Baseline',       [-0.1, 0], ...
         'DataTimeWindow', [0, 1], ...
         'RemoveDcOffset', 'file'), ...
    'removeevoked',  0, ...
    'cohmeasure',    'mscohere', ...  % Magnitude-squared coherence
    'tfmeasure',     'hilbert', ...  % Hilbert transform
    'tfedit',        struct(...
         'Comment',         'Complex', ...
         'TimeBands',       [], ...
         'Freqs',           {{'theta', '5, 7', 'mean'}}, ...
         'ClusterFuncTime', 'none', ...
         'Measure',         'none', ...
         'Output',          'all', ...
         'SaveKernel',      0), ...
    'timeres',       'windowed', ...  % Windowed
    'avgwinlength',  5, ...
    'avgwinoverlap', 50, ...
    'outputmode',    'input');  % separately for each file

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);
% bst_report('Email', ReportFile, username, to, subject, isFullReport);

% Delete temporary files
% gui_brainstorm('EmptyTempFolder');

